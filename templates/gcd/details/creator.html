{% extends "gcd/base_view.html" %}
{% load url from future %}
{% load staticfiles %}
{% load i18n %}

{% block title %}
    GCD :: Creator :: {{ creator }}
{% endblock %}

{% block css %}
    <link rel="stylesheet" type="text/css"
          href="{% static "css/gcd/default.css" %}"/>
{% endblock %}

{% block view_body %}
    {% include "gcd/bits/creator_header.html" %}

    <div class="control_body">
        <div id="control_container">
            <div id="control_center">
                <div class="pub_data">
                    <div class="table-container">
                    <p><strong>Born:</strong> {{ creator.display_birthday }} in {{ creator.display_birthplace }}</p>
                    {% if creator.has_death_info %}
                    <p><strong>Died:</strong> {{ creator.display_deathday }} in {{ creator.display_deathplace }}</p>
                    {% endif %}
                    {% for name, value in creator.get_text_fields.items %}
                        {% if value %}
                        <p><strong>{{ name }}</strong> : {{ value }}</p>
                        {% endif %}
                    {% endfor %}
                    {% if creator.whos_who %}
                    <p><strong>Who's Who:</strong> {{ creator.whos_who|urlize }}</p>
                    {% endif %}
                    {% if creator.bio %}
                    <p><strong>Biography:</strong> {{ creator.bio|linebreaksbr }}</p>
                    {% endif %}
                    {% if creator.notes %}
                    <p><strong>Notes:</strong> {{ creator.notes|urlizetrunc:75|linebreaksbr }}</p>
                    {% endif %}
                    </div>
                    {% if creator.portrait %}
                        <h3>Portrait Image:</h3>
                        <img src="{{ creator.portrait.scaled_image.url }}">
                    {% endif %}

                    <!--Portrait  Sources-->
                    {% if creator.portrait_source.all %}
                        <hr>
                        <h3>Portrait Sources</h3>
                        <p><strong>sources</strong> :
                            {% for portrait in creator.portrait_source.all %}
                                {{ portrait }},
                            {% endfor %}
                        </p>
                    {% endif %}

                    <!--Bio  Sources-->
                    {% if creator.bio_source.all %}
                        <hr>
                        <h3>Bio Sources</h3>
                        <p><strong>sources</strong> :
                            {% for bio in creator.bio_source.all %}
                                {{ bio }},
                            {% endfor %}
                        </p>
                    {% endif %}

                    {% if creator.samplescan %}
                        <h3>Sample Scan:</h3>
                        <img src="{{ creator.samplescan.scaled_image.url }}">
                    {% endif %}

                    <!--Creator's Names-->
                    <hr>
                    <h3>Names:</h3>
                    {% for creator_name in creator.active_names %}
                        <p>{{ forloop.counter }}. {{ creator_name.name }}
                        <strong> type</strong>: {{ creator_name.type }}</p>
                        {% if creator_name.source.all %}
                            <p><strong>Sources</strong> :{% for source in creator_name.source.all %}
                                {{ source.type }},{% endfor %}</p>
                        {% endif %}
                        {% if creator_name.active_relations %}
                            {% for relation in creator_name.active_relations %}
                                <p><strong>Relation Type</strong>
                                    : {{ relation.rel_type.type }}</p>
                                {% if relation.rel_source.all %}
                                    <p><strong>Relation sources</strong> :
                                        {% for source in relation.rel_source.all %}
                                            {{ source.type }},{% endfor %}
                                    </p>
                                {% endif %}
                            {% endfor %}
                        {% endif %}
                    {% endfor %}

                    <!--Creator's Schools-->
                    {% if creator.cr_creator_school.all %}
                        <hr>
                        {% for school_obj in creator.cr_creator_school.all %}
                            <h3>Schools:{{ forloop.counter }}</h3>
                            <p><strong>School name</strong>
                                : {{ school_obj.school.school_name }}</p>
                            {% if school_obj.school_year_began %}
                                <p><strong>School year began</strong>
                                    : {{ school_obj.school_year_began }}</p>
                            {% endif %}
                            <p><strong>School year began uncertain</strong>
                                : {{ school_obj.school_year_began_uncertain }}
                            </p>
                            {% if school_obj.school_year_ended %}
                                <p><strong>School year ended</strong>
                                    : {{ school_obj.school_year_ended }}</p>
                            {% endif %}
                            <p><strong>School year ended uncertain</strong>
                                : {{ school_obj.school_year_ended_uncertain }}
                            </p>
                            {% if school_obj.school_source.all %}
                                <p><strong>School source</strong> :
                                    {% for source in school_obj.school_source.all %}
                                        {{ source.type }},{% endfor %}</p>
                            {% endif %}
                        {% endfor %}

                    {% elif creator.creator_school.all %}
                        <hr>
                        {% for school_obj in creator.creator_school.all %}
                            <h3>Schools:{{ forloop.counter }}</h3>
                            <p><strong>School name</strong>
                                : {{ school_obj.school.school_name }}</p>
                            {% if school_obj.school_year_began %}
                                <p><strong>School year began</strong>
                                    : {{ school_obj.school_year_began }}</p>
                            {% endif %}
                            {% if school_obj.school_year_began_uncertain %}
                                <p><strong>School year began uncertain</strong>
                                    : {{ school_obj.school_year_began_uncertain }}
                                </p>
                            {% endif %}
                            {% if school_obj.school_year_ended %}
                                <p><strong>School year ended</strong>
                                    : {{ school_obj.school_year_ended }}</p>
                            {% endif %}
                            <p><strong>School year ended uncertain</strong>
                                : {{ school_obj.school_year_ended_uncertain }}
                            </p>
                            {% if school_obj.school_source.all %}
                                <p><strong>School source</strong> :
                                    {% for source in school_obj.school_source.all %}
                                        {{ source.type }},{% endfor %}</p>
                            {% endif %}
                        {% endfor %}
                    {% endif %}

                    <!--Creator's Degree-->
                    {% if creator.cr_creator_degree.all %}
                        <hr>
                        {% for degree_obj in creator.cr_creator_degree.all %}
                            <h3>Degrees: {{ forloop.counter }}</h3>
                            <p><strong>Degree name</strong>
                                : {{ degree_obj.degree.degree_name }}</p>
                            <p><strong>School name</strong>
                                : {{ degree_obj.school.school_name }}</p>
                            {% if degree_obj.degree_year %}
                                <p><strong>Degree year</strong>
                                    : {{ degree_obj.degree_year }}</p>
                            {% endif %}
                            <p><strong>Degree year uncertain</strong>
                                : {{ degree_obj.degree_year_uncertain }}</p>
                        {% endfor %}
                    {% elif creator.creator_degree.all %}
                        <hr>
                        {% for degree_obj in creator.creator_degree.all %}
                            <h3>Degrees: {{ forloop.counter }}</h3>
                            <p><strong>Degree name</strong>
                                : {{ degree_obj.degree.degree_name }}</p>
                            <p><strong>School name</strong>
                                : {{ degree_obj.school.school_name }}</p>
                            {% if degree_obj.degree_year %}
                                <p><strong>Degree year</strong>
                                    : {{ degree_obj.degree_year }}</p>
                            {% endif %}
                            <p><strong>Degree year uncertain</strong>
                                : {{ degree_obj.degree_year_uncertain }}</p>
                        {% endfor %}
                    {% endif %}


                    <!--Creator's Awards-->
                    {% if creator.active_awards %}
                        <hr>
                        {% for award in creator.active_awards %}
                            <h3>Awards:</h3>
                            {% if not award.deleted %}
                                <p>{{ forloop.counter }}. <a href="{{ award.get_absolute_url }}">{{ award.award_name }}</a>
                                {% if award.award_year %}
                                    year: {{ award.award_year }}
                                {% endif %}
                                </p>
                                {% if award.award_source.all %}
                                    <p><strong>Award source</strong> :{% for source in award.award_source.all %}
                                        {{ source.type }},{% endfor %}</p>
                                {% endif %}
                            {% endif %}
                        {% endfor %}
                    {% endif %}

                    <!--Creator's Art Influences-->
                    {% if creator.active_artinfluences %}
                        <hr>
                        <h3>Art Influences:</h3>
                        {% for influence in creator.active_artinfluences %}
                                <p>{{ forloop.counter }}. <a href="{{ influence.get_absolute_url }}">{{ influence.influence_name }}</a>
                                {% if influence.is_self_identify %}
                                    {% if influence.self_identify_influences_doc %}
                                        <p><strong>Influence Doc. </strong>{{ influence.self_identify_influences_doc }}
                                        </p>
                                    {% endif %}
                                {% endif %}
                                </p>
                                {% if influence.influence_source.all %}
                                    <p><strong>Influence source</strong> :
                                        {% for source in influence.influence_source.all %} {{ source.type }}
                                            , {% endfor %}</p>
                                {% endif %}
                        {% endfor %}
                    {% endif %}

                    <!--Creator's Memberships-->
                    {% if creator.active_memberships %}
                        <hr>
                        <h3>Memberships:</h3>
                        {% for membership in creator.active_memberships %}
                                <p>{{ forloop.counter }}. <a href="{{ membership.get_absolute_url }}">{{ membership.organization_name }}</a>
                                <strong>type</strong>: {{ membership.membership_type.type }}
                                <strong>year begin</strong> : {{ membership.membership_begin_year|default:'?' }}
                                <strong>year ended</strong> : {{ membership.membership_end_year|default:'?' }}</p>
                                {% if membership.membership_source.all %}
                                    <p><strong>Membership source</strong> :
                                        {% for source in membership.membership_source.all %} {{ source.type }}
                                            ,{% endfor %}</p>
                                {% endif %}
                        {% endfor %}
                    {% endif %}

                    <!--Creator's Noncomic works-->
                    {% if creator.active_noncomicworks %}
                        <hr>
                        <h3>Non Comics Works:</h3>
                        {% for ncw in creator.active_noncomicworks %}
                                <p>{{ forloop.counter }}. <strong>Publication title</strong>: <a href="{{ ncw.get_absolute_url }}">{{ ncw.publication_title }}</a>
                                <strong>Work type</strong> : {{ ncw.work_type.type }}</p>
                                {% if ncw.employer_name %}
                                    <p><strong>Employer name</strong> : {{ ncw.employer_name }}</p>
                                {% endif %}
                                {% if ncw.work_title %}
                                    <p><strong>Work title</strong> : {{ ncw.work_title }}</p>
                                {% endif %}
                                <p><strong>Work role</strong> : {{ ncw.work_role.role_name }}</p>
                                {% if ncw.work_notes %}
                                    <p><strong>Work notes</strong> : {{ ncw.work_notes }}</p>
                                {% endif %}
                                {% if ncw.work_source.all %}
                                    <p><strong>Work source</strong> :
                                        {% for source in ncw.work_source.all %}{{ source.type }}, {% endfor %}</p>
                                {% endif %}
                                {% for year in ncw.noncomicworkyear_set.all %}
                                    {% if forloop.first %}
                                        <p><strong>Year(s)</strong> :
                                    {% endif %}
                                {{ year.work_year }}{% if not forloop.last %}, {% endif %}
                                {% if forloop.last %}
                                    </p>
                                {% endif %}
                                {% endfor %}
                                {% for link in ncw.noncomicworklink_set.all %}
                                    {% if forloop.first %}
                                        <p><strong>Link(s)</strong> :
                                    {% endif %}
                                <a href="{{ link.link }}">{{ link.link }}</a>{% if not forloop.last %}, {% endif %}
                                {% if forloop.last %}
                                    </p>
                                {% endif %}
                                {% endfor %}
                        {% endfor %}
                    {% endif %}
                    <br>

                </div> <!-- pub_data -->
            </div> <!-- control_center -->


            {% if not preview or creator.source %}
                <div id="control_rail">
                <div class="edit_box">
                    <div class="edit_header">Editing</div>
                    {% if not preview %}
                        {% with creator as object %}
                            {% with 'creator' as object_class %}
                                {% with 'creator' as object_name %}
                                    {% include "gcd/bits/status_banner.html" %}
                                {% endwith %}
                            {% endwith %}
                        {% endwith %}
                        {% if user.is_authenticated and not creator.pending_deletion %}
                            <a href="{% url "add_creator_artinfluence" creator.id %}">
                                <button>Add Influence</button>
                            </a>
                            <a href="{% url "add_creator_membership" creator.id %}">
                                <button>Add Membership</button>
                            </a>
                            <a href="{% url "add_creator_award" creator.id %}">
                                <button>Add Award</button>
                            </a>
                            <a href="{% url "add_creator_non_comic_work" creator.id %}">
                                <button>Add NonComic Work</button>
                            </a>
                        {% endif %}
                        {% if creator.portrait %}
                            {% if creator.portrait.reserved %}
                                <div style='padding:.4em' class="index_status_1">
                                    Creator portrait changes pending
                                </div>
                            {% else %}
                                {% if user.is_authenticated %}
                                    <form method="GET"
                                          action="{% url "replace_image" model_name='creator' id=creator.id image_id=creator.portrait.id %}">
                                        <input type="submit" value="{% trans 'Replace Portrait image' %}">
                                    </form>
                                    <form method="GET"
                                          action="{% url "delete_revision" model_name='image' id=creator.portrait.id %}">
                                        <input type="submit" value="{% trans 'Delete Portrait image' %}">
                                    </form>
                                {% endif %}
                            {% endif %}
                        {% else %}
                            {% if user.is_authenticated %}
                                <form method="GET"
                                      action="{% url "upload_image" model_name='creator' id=creator.id image_type='CreatorPortrait' %}">
                                    <input type="submit" value="{% trans 'Add Portrait image' %}">
                                </form>
                            {% endif %}
                        {% endif %}

                        {% if creator.samplescan %}
                            {% if creator.samplescan.reserved %}
                                <div style='padding:.4em' class="index_status_1">
                                    Creator sample scan changes pending
                                </div>
                            {% else %}
                                {% if user.is_authenticated %}
                                    <form method="GET"
                                          action="{% url "replace_image" model_name='creator' id=creator.id image_id=creator.samplescan.id %}">
                                        <input type="submit" value="{% trans 'Replace sample scan image' %}">
                                    </form>
                                    <form method="GET"
                                          action="{% url "delete_revision" model_name='image' id=creator.samplescan.id %}">
                                        <input type="submit" value="{% trans 'Delete sample scan image' %}">
                                    </form>
                                {% endif %}
                            {% endif %}
                        {% else %}
                            {% if user.is_authenticated %}
                                <form method="GET"
                                      action="{% url "upload_image" model_name='creator' id=creator.id image_type='SampleScan' %}">
                                    <input type="submit" value="{% trans 'Add Sample scan image' %}">
                                </form>
                            {% endif %}
                        {% endif %}
                    {% endif %} <!-- not preview -->
                </div> <!-- control_rail -->
                <div id="change_history" class="edit_footer">
                    {% if preview %}
                        <a href="{% url "change_history" model_name='creator' id=creator.source.id %}">View Change History</a>
                    {% else %}
                        <a href="{% url "change_history" model_name='creator' id=creator.id %}">View Change History</a>
                    {% endif %}
                </div>
            {% endif %}
            </div> <!-- control_container -->
        </div> <!-- control_body -->
    </div>
{% endblock %}
