{% load compare %}
{% load staticfiles %}

<form action="{% url 'process' id=changeset.id %}" method="POST"
      enctype="multipart/form-data">
    {% csrf_token %}
    {% include 'oi/bits/creator_before_form.html' %}
    <table class="editing" style="padding-top: 10px;">
        {{ form.as_table }}
    </table>

    {% include 'oi/bits/creator_after_form.html' %}

    {% if changeset.comments.count > 1 %}
        {% comment %} change was sent back {% endcomment %}
        <p>
            <a href="{% url 'compare' id=changeset.id %}">Compare changes</a>
        </p>
    {% endif %}
    {% with changeset.comments as comments %}
        {% include 'oi/bits/comments.html' %}
    {% endwith %}
    {% ifequal revision.source_label "story" %}
        <input type="submit" name="save"
               value="Save and continue editing"></input>
        <input type="submit" name="save_return"
               value="Save and return to issue"></input>
        <input type="submit" name="cancel_return"
               value="Return to issue without saving"></input>
    {% else %}
        {% ifequal revision.source_label "issue" %}
            <input type="submit" name="save"
                   value="Save and continue editing"></input>
        {% endifequal %}
        <input type="submit" name="submit"
               value="Submit changes for approval"></input>
        {% if changeset.approver %}
            <input type="submit" name="discuss" value="Discuss">
        {% endif %}
        <input type="submit" id="discard" name="discard"
               value="Discard all changes"></input>
    {% endifequal %}
</form>

{% include 'oi/bits/jquery.html' %}
{% include 'oi/bits/creatorrevision_form_utils.html' %}

